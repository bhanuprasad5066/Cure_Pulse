{% extends "base.html" %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="mb-6">
        <h1 class="text-3xl font-bold">Patient Registration</h1>
        <p class="text-gray-400">Please fill in your details accurately.</p>
    </div>

    <form action="/register" method="POST" enctype="multipart/form-data" class="glass p-8 rounded-xl space-y-6">
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" name="full_name" placeholder="Full Name" required class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="email" name="email" placeholder="Email Address" required class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="tel" name="phone" placeholder="Phone Number" required class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="date" name="dob" required class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none text-gray-400">
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" name="gender" placeholder="Gender" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="text" name="address" placeholder="Address" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
        </div>

        <h2 class="text-xl font-semibold text-brand mt-4">Medical Details</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" name="primary_physician" placeholder="Primary Physician" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="text" name="insurance_provider" placeholder="Insurance Provider" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <input type="text" name="insurance_policy_number" placeholder="Policy Number" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
            <textarea name="allergies" placeholder="Allergies (if any)" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none"></textarea>
        </div>
        
        <textarea name="current_medications" placeholder="Current Medications" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none"></textarea>
        <textarea name="family_medical_history" placeholder="Family Medical History" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none"></textarea>

        <h2 class="text-xl font-semibold text-brand mt-4">Identification</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <select name="identification_type" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none text-gray-400">
                <option>Birth Certificate</option>
                <option>Driver's License</option>
                <option>Passport</option>
            </select>
            <input type="text" name="identification_number" placeholder="ID Number" class="bg-dark-400 border border-dark-500 rounded-lg p-3 w-full focus:border-brand outline-none">
        </div>
        
        <div id="file-upload-area" class="border-2 border-dashed border-dark-500 rounded-lg p-6 text-center cursor-pointer hover:border-brand transition">
            <label for="document-input" class="cursor-pointer block">
                <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span id="upload-text" class="text-brand block mt-2">Click to upload document</span>
                <span id="file-name" class="text-white text-sm mt-2 hidden"></span>
                <input type="file" name="document" id="document-input" class="hidden" accept="image/*,.pdf">
            </label>
            <p class="text-xs text-gray-500 mt-2">SVG, PNG, JPG, PDF or GIF (max. 16MB)</p>
            <div id="file-preview" class="mt-4 hidden">
                <img id="preview-image" class="mx-auto max-h-32 rounded border border-dark-500" alt="Preview">
            </div>
        </div>

        <script>
            // File upload preview and name display
            document.getElementById('document-input').addEventListener('change', function(e) {
                const file = e.target.files[0];
                const uploadText = document.getElementById('upload-text');
                const fileName = document.getElementById('file-name');
                const filePreview = document.getElementById('file-preview');
                const previewImage = document.getElementById('preview-image');
                const uploadArea = document.getElementById('file-upload-area');
                
                if (file) {
                    // Show file name
                    uploadText.textContent = 'âœ“ File Selected';
                    fileName.textContent = file.name + ' (' + (file.size / 1024).toFixed(2) + ' KB)';
                    fileName.classList.remove('hidden');
                    uploadArea.classList.add('border-brand', 'bg-dark-400');
                    
                    // Show preview for images
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            previewImage.src = e.target.result;
                            filePreview.classList.remove('hidden');
                        }
                        reader.readAsDataURL(file);
                    } else {
                        filePreview.classList.add('hidden');
                    }
                }
            });
        </script>

        <div class="flex items-center gap-2">
            <input type="checkbox" name="privacy_consent" id="privacy" required class="accent-brand w-4 h-4">
            <label for="privacy" class="text-sm text-gray-400">I consent to the processing of my medical data.</label>
        </div>

        <button type="submit" class="w-full bg-brand hover:bg-green-600 text-white font-bold py-4 rounded-lg transition">Submit & Continue</button>
    </form>
</div>
{% endblock %}
